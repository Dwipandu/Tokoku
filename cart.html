<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Keranjang - BukuKita</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header>
    <h1>BukuKita</h1>
    <nav>
      <a href="index.html">Beranda</a>
      <a href="cart.html">Keranjang</a>
      <a href="checkout.html">Checkout</a>
    </nav>
  </header>
  <main>
    <h2>Keranjang Belanja</h2>
    <div id="cart-container"></div>
  </main>

  <script src="js/cart.js"></script>
  <script>
    const products = {
      1: { id: 1, title: 'Judul Buku 1', price: 75000 },
      2: { id: 2, title: 'Judul Buku 2', price: 85000 },
      3: { id: 3, title: 'Judul Buku 3', price: 95000 },
      4: { id: 4, title: 'Judul Buku 4', price: 120000 },
    };

    const cartContainer = document.getElementById('cart-container');

    function renderCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || {};
      cartContainer.innerHTML = '';

      if (Object.keys(cart).length === 0) {
        cartContainer.innerHTML = '<p>Keranjang kosong.</p>';
        return;
      }

      let total = 0;
      const table = document.createElement('table');
      table.style.width = '100%';
      table.innerHTML = `
        <thead>
          <tr>
            <th>Buku</th>
            <th>Jumlah</th>
            <th>Harga</th>
            <th>Subtotal</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody></tbody>
      `;
      const tbody = table.querySelector('tbody');

      for (const id in cart) {
        const qty = cart[id];
        const product = products[id];
        const subtotal = product.price * qty;
        total += subtotal;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${product.title}</td>
          <td><input type="number" min="1" value="${qty}" data-id="${id}" class="qty-input" style="width:60px" /></td>
          <td>Rp ${product.price.toLocaleString('id-ID')}</td>
          <td>Rp ${subtotal.toLocaleString('id-ID')}</td>
          <td><button class="btn-remove" data-id="${id}">Hapus</button></td>
        `;
        tbody.appendChild(tr);
      }

      const trTotal = document.createElement('tr');
      trTotal.innerHTML = `
        <td colspan="3" style="text-align:right; font-weight:bold;">Total:</td>
        <td colspan="2" style="font-weight:bold;">Rp ${total.toLocaleString('id-ID')}</td>
      `;
      tbody.appendChild(trTotal);

      cartContainer.appendChild(table);

      // Event update qty
      const qtyInputs = document.querySelectorAll('.qty-input');
      qtyInputs.forEach(input => {
        input.addEventListener('change', e => {
          const id = e.target.getAttribute('data-id');
          let val = parseInt(e.target.value);
          if (isNaN(val) || val < 1) val = 1;
          updateQuantity(id, val);
        });
      });

      // Event hapus
      const btnRemove = document.querySelectorAll('.btn-remove');
      btnRemove.forEach(btn => {
        btn.addEventListener('click', e => {
          const id = e.target.getAttribute('data-id');
          removeFromCart(id);
        });
      });
    }

    function updateQuantity(id, qty) {
      const cart = JSON.parse(localStorage.getItem('cart')) || {};
      cart[id] = qty;
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    function removeFromCart(id) {
      const cart = JSON.parse(localStorage.getItem('cart')) || {};
      delete cart[id];
      localStorage.setItem('cart', JSON.stringify(cart));
      renderCart();
    }

    renderCart();
  </script>
</body>
</html>
